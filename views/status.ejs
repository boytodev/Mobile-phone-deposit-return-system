<%# views/status.ejs %> <%- include('partials/header') %> <%# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πåcss %>
<link rel="stylesheet" href="/public/css/style.css" />

<%# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå ‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á %>
<button
  type="button"
  id="printButton"
  style="
    padding: 8px 15px;
    margin-bottom: 20px;
    cursor: pointer;
    font-size: 1rem;
  "
>
  üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
</button>

<% if (logs && logs.length > 0) { %>
<p>
  ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <%= currentDate.toLocaleDateString('th-TH', { year:
  'numeric', month: 'long', day: 'numeric', weekday: 'long' }) %>
</p>
<%# ‡πÄ‡∏û‡∏¥‡πà‡∏° div ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå %>
<div id="printableArea">
  <table>
    <thead>
      <tr>
        <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
        <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</th>
        <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
      </tr>
    </thead>
    <tbody>
      <% logs.forEach((log, index) => { %> <% if (log.student) { %>
      <tr>
        <td><%= index + 1 %></td>
        <td><%= log.student.studentId %></td>
        <td><%= log.student.firstName %> <%= log.student.lastName %></td>
        <td>
          <% if (log.status === 'checked-in') { %>
          <span class="status-in">‚úÖ ‡∏ù‡∏≤‡∏Å‡∏≠‡∏¢‡∏π‡πà</span>
          <% } else if (log.status === 'checked-out') { %>
          <span class="status-out">‚ùå ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
          <% } else { %> <%= log.status %> <% } %>
        </td>
        <td>
          <%= new Date(log.updatedAt).toLocaleString('th-TH', { dateStyle:
          'short', // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡πÄ‡∏ä‡πà‡∏ô 5/4/2568) timeStyle: 'medium', //
          ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô 10:42:33) timeZone: 'Asia/Bangkok' // <--
          ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ }) %>
        </td>
      </tr>
      <% } else { %>
      <tr>
        <td><%= index + 1 %></td>
        <td colspan="4" style="color: grey">
          <i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Log ‡∏ô‡∏µ‡πâ</i>
        </td>
      </tr>
      <% } %> <% }); %>
    </tbody>
  </table>
</div>
<%# ‡∏õ‡∏¥‡∏î div#printableArea %> <% } else { %>
<p>
  ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ù‡∏≤‡∏Å-‡∏Ñ‡∏∑‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <%=
  currentDate.toLocaleDateString('th-TH') %>
</p>
<% } %> <%- include('partials/footer') %> <%# ‡πÄ‡∏û‡∏¥‡πà‡∏° JavaScript ‡∏ó‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå %>
<script>
  const printBtn = document.getElementById("printButton");
  if (printBtn) {
    printBtn.addEventListener("click", function () {
      // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ Browser ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á Print Dialog
      window.print();
    });
  }
</script>
